<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
    <title>Skyper&#x27;s blog - NTP</title>
    <subtitle>Personal blog about IT, Electronics, InfoSec, Hacking, Bug Hunting...</subtitle>
    <link rel="self" type="application/atom+xml" href="https://blog.skyplabs.net/tags/ntp/atom.xml"/>
    <link rel="alternate" type="text/html" href="https://blog.skyplabs.net"/>
    <generator uri="https://www.getzola.org/">Zola</generator>
    <updated>2014-04-25T00:00:00+00:00</updated>
    <id>https://blog.skyplabs.net/tags/ntp/atom.xml</id>
    <entry xml:lang="en">
        <title>[Linux] Mettre à jour l&#x27;heure de son système par internet sans NTP</title>
        <published>2014-04-25T00:00:00+00:00</published>
        <updated>2014-04-25T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://blog.skyplabs.net/posts/linux-update-datetime-without-ntp/"/>
        <id>https://blog.skyplabs.net/posts/linux-update-datetime-without-ntp/</id>
        
        <content type="html" xml:base="https://blog.skyplabs.net/posts/linux-update-datetime-without-ntp/">&lt;p&gt;Voici une astuce trouvée sur un &lt;a rel=&quot;noopener nofollow noreferrer&quot; target=&quot;_blank&quot; title=&quot;How to use ntpdate behind a proxy&quot; href=&quot;https:&#x2F;&#x2F;superuser.com&#x2F;questions&#x2F;307158&#x2F;how-to-use-ntpdate-behind-a-proxy&#x2F;465838#465838&quot;&gt;forum&lt;&#x2F;a&gt; permettant de mettre à jour
l&#x27;heure d&#x27;un système sous Linux par internet mais sans utiliser NTP :&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;date -s &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;wget -S  &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;https:&#x2F;&#x2F;www.google.com&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;&amp;gt;&amp;amp;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1 &lt;&#x2F;span&gt;&lt;span&gt;| &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;grep -E &lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;^[[:space:]]*[dD]ate:&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39; | &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sed &lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;s&#x2F;^[[:space:]]*[dD]ate:[[:space:]]*&#x2F;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39; | &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;head -1l &lt;&#x2F;span&gt;&lt;span&gt;| &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;awk &lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{print $1, $3, $2,  $5 ,&amp;quot;GMT&amp;quot;, $4 }&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39; | &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sed &lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;s&#x2F;,&#x2F;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Le principe est d&#x27;utiliser le champ &lt;code&gt;Date&lt;&#x2F;code&gt; se trouvant dans les en-têtes
&lt;strong&gt;HTTP&lt;&#x2F;strong&gt; de la réponse d&#x27;un serveur web lors d&#x27;une requête vers celui-ci. Il
faut cependant s&#x27;assurer que le serveur web contacté soit à l&#x27;heure, lui ! Le
choix du moteur de recherche Google est donc une bonne idée.&lt;&#x2F;p&gt;
&lt;p&gt;L&#x27;utilisation de cette méthode se justifie lorsque l&#x27;on veut mettre à jour
l&#x27;heure d&#x27;une machine se trouvant derrière un proxy.&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>[FreeBSD] adjkerntz dans une jail</title>
        <published>2012-09-22T00:00:00+00:00</published>
        <updated>2012-09-22T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://blog.skyplabs.net/posts/freebsd-adjkerntz-inside-jail/"/>
        <id>https://blog.skyplabs.net/posts/freebsd-adjkerntz-inside-jail/</id>
        
        <content type="html" xml:base="https://blog.skyplabs.net/posts/freebsd-adjkerntz-inside-jail/">&lt;p&gt;Le programme adjkerntz (installé par défaut sous FreeBSD) permet de maintenir
une relation cohérente entre l&#x27;horloge du noyau, qui est toujours configurée à
l&#x27;heure UTC, et l&#x27;horloge locale CMOS, qui peut être configurée au fuseau local.&lt;&#x2F;p&gt;
&lt;p&gt;Cependant, au sein d&#x27;une jail, seul le fuseau horaire peut être modifié. La jail
utilise donc la même heure que celle configurée sur le système hôte.
L&#x27;utilisation de la commande adjkerntz va donc provoquer une erreur :&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2b303b;color:#c0c5ce;&quot;&gt;&lt;code&gt;&lt;span&gt;Sep 22 05:31:00 www adjkerntz[23948]: sysctl(set: &amp;quot;machdep.wall_cmos_clock&amp;quot;): Operation not permitted
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Si vous rencontrez des messages similaires dans vos logs, c&#x27;est tout simplement
parce que la commande &lt;code&gt;adjkerntz&lt;&#x2F;code&gt; est invoquée régulièrement par &lt;strong&gt;cron&lt;&#x2F;strong&gt;. Pour
résoudre ce problème, il suffit de commenter la ligne suivante dans le fichier
&lt;code&gt;&#x2F;etc&#x2F;crontab&lt;&#x2F;code&gt; de vos jails :&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2b303b;color:#c0c5ce;&quot;&gt;&lt;code&gt;&lt;span&gt;# Adjust the time zone if the CMOS clock keeps local time, as opposed to
&lt;&#x2F;span&gt;&lt;span&gt;# UTC time.  See adjkerntz(8) for details.
&lt;&#x2F;span&gt;&lt;span&gt;#1,31   0-5     *       *       *       root    adjkerntz -a
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Vos logs seront plus propres désormais.&lt;&#x2F;p&gt;
</content>
        
    </entry>
</feed>
